<a id="readme-top"></a>

# Network Labs & Topology Definitions

This directory contains the **Containerlab topology definitions** and configuration files that define the project's virtualized environment.

Each lab is encapsulated in a `*.clab.yml` file, which describes the network nodes, their connections, and the Docker images they use. This modular approach allows for the independent deployment and management of different network scenarios.

## Table of Contents

- [Directory Structure](#directory-structure)
- [Topology Overview](#topology-overview)
    - [Considerations](#considerations)
    - [Architecture](#architecture)
    - [Network Zones](#network-zones)
- [Configuration Strategy](#configuration-strategy)
- [Extensibility](#extensibility)
- [External Resources](#external-resources)

## Directory Structure

The directory is organized to separate the topology definition files from the runtime configurations of the network devices.

```text
labs/
├── topology.clab.yml       # The main topology definition file
├── config/                 # Configuration files mounted to containers
│   ├── router/             # FRR configs and startup scripts for routers
│   ├── firewall/           # Startup scripts and iptables rules
│   ├── switch/             # Arista cEOS startup configs
│   └── mls/                # (Optional) Multilayer switch configs
└── clab-virtual-env/       # (Generated Automatically) Containerlab runtime artifacts
```

- `topology.clab.yml`: The YAML file defining the nodes, links, and image references.
- `config/`: Contains persistent configuration files (e.g., frr.conf, startup.sh, .cli). These are mounted into the containers at runtime, allowing configuration changes without rebuilding images.
- `clab-virtual-env/`: A directory automatically generated by Containerlab during deployment. It contains runtime data and should not be manually modified or committed to the version control system.

<p align="right">(<a href="#readme-top">back to top</a>)</p>

## Topology Overview

The provided topology simulates a multi-zone enterprise network connected to simulated external networks (Internet, Attacker, Benign). This design allows for realistic traffic flow, routing, and security experimentation.

### Considerations

Although the objective of such environment is to simulate a real-life environment and enterprise network, some simplifications have been applied to ensure the environment is lighter in terms of computing capabilities. For such, some connections / configurations are not fully realistic, to avoid non-relevant settings.

### Architecture

The network is logically divided into four distinct zones:

1. **Internet Zone:** Simulates the public internet backbone.
2. **Attacker Network:** A hostile external network for generating malicious traffic.
3. **Benign Network:** A trusted external network for generating legitimate user traffic.
4. **Enterprise Network:** The internal corporate infrastructure, segmented into multiple VLANs and protected by a firewall.

All zones are interconnected via an Internet Router, which handles routing (OSPF) between the external networks and the enterprise edge.

### Network Zones

1. **Internet Zone**
    - **Nodes:** `router_internet` (FRR), `internet_server` (Alpine).
    - **Role:** Acts as the central routing hub, providing connectivity between all other zones. It simulates the ISP, routing traffic between the attacker, benign users, and the enterprise.

2. **Attacker Network**
    - **Nodes:** `router_attacker` (FRR), `attacker` (Kali Linux).
    - **Role:** Represents a malicious network. The Kali Linux node is equipped with tools to launch attacks against the enterprise infrastructure.

3. **Benign Network**
    - **Nodes:** `router_benign` (FRR), `benign` (Alpine).
    - **Role:** Represents normal external users. Traffic generated from here is considered safe and serves as a baseline for differentiating benign traffic from anomalies.

4. **Enterprise Network**

    This is the core of the simulation, representing a segmented corporate LAN.

    - **Edge:** `router_enterprise` (Debian) handles NAT and connects to the Internet.
    - **Security:** `firewall` (Debian) applies traffic policies between zones using iptables.
    - **Internal Segments (VLANs):**
        - **DMZ (VLAN 10):** Hosts public-accessible services (e.g., Web).
        - **Monitoring (VLAN 20):** Dedicated segment for IDS (Suricata) and log processing.
        - **Admin (VLAN 30):** Restricted management network.
        - **Services (VLAN 40):** Internal services not exposed to the public.
        - **User Floors (VLAN 50 & 60):** Simulated workstation networks for employees.

<p align="right">(<a href="#readme-top">back to top</a>)</p>

## Configuration Strategy

To maintain flexibility and reproducibility, configurations are *decoupled* from the Docker images.

- **Routers (FRR):** Use frr.conf files mounted from config/router/.
- **Firewall & Servers:** Use startup.sh scripts to apply IP addressing, routing, and iptables rules at boot.
- **Switches (Arista cEOS):** Use startup-config files to define VLANs and trunking on initialization.

This approach allows to modify routing protocols or firewall rules by simply editing the files in config/ and restarting the lab, without the need to rebuild Docker images.

<p align="right">(<a href="#top">back to top</a>)</p>

## Extensibility

The environment is designed to be easily extended. You can:

- Additional topologies can be added by creating new `*.clab.yml` files.
- Different network OSes can be used interchangeably.
- The topology is designed to be extended and or replaced.

Official Containerlab examples are provided on the web site to experiment and expand knowledge.

Some images can not be imported into containerlab, as many product are shipped only in virtual machine packaging. Such machines can be used in Containerlab but require additional steps such as:
- Obtaining the image manually
- Obtain the `vrnetlab` package
- Follow the instructions provided for the specified image

In detail steps to manage such machines can be found at: [VM based routers integration](https://containerlab.dev/manual/vrnetlab/)

And the Git repository in charge of packaging VMs into containers can be found at: [vrnetlab](https://github.com/srl-labs/vrnetlab)

<p align="right">(<a href="#readme-top">back to top</a>)</p>

## External Resources

Some additional resoruces that may help:

- Topology definition: [Containerlab](https://containerlab.dev/manual/topo-def-file/)

- Official Examples: [Containerlab](https://containerlab.dev/lab-examples/lab-examples/)

<p align="right">(<a href="#readme-top">back to top</a>)</p>
